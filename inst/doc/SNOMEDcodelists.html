<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Anoop Shah" />

<meta name="date" content="2025-01-28" />

<title>Using SNOMED dictionaries and codelists</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using SNOMED dictionaries and codelists</h1>
<h4 class="author">Anoop Shah</h4>
<h4 class="date">2025-01-28</h4>



<div id="using-snomed-dictionaries-and-codelists" class="section level1">
<h1>Using SNOMED dictionaries and codelists</h1>
<p>This package is designed to make it easier to use SNOMED CT in R, including searching the SNOMED CT dictionary and relations, and creating and manipulating SNOMED CT codelists.</p>
<div id="basic-introduction-to-snomed-ct" class="section level2">
<h2>Basic introduction to SNOMED CT</h2>
<p>SNOMED CT is a clinical terminology system which contains thousands of concepts, each of which has a distinct meaning. Each concept has a unique concept ID, and one or more descriptions (synonyms). It also contains a knowledge model (ontology), specifying which concepts are subtypes of another concept or associated in other ways.</p>
<p>The SNOMED dictionaries are contained within four key tables:</p>
<ul>
<li>CONCEPT - one row per concept, with key metadata about the concepts</li>
<li>DESCRIPTION - one row per description</li>
<li>STATEDRELATIONSHIP - directly stated relationships</li>
<li>RELATIONSHIP - relationships between terms inferred from other relationships</li>
</ul>
<p>The following additional tables are also included: - SIMPLEMAP - Maps to Clinical Terms Version 3 and some other terms (e.g. COVID-19 terms) - EXTENDEDMAP - Maps to ICD-10 and OPCS4 - REFSET - Sets of SNOMED CT concepts used for specific clinical / operational purposes</p>
<p>Each SNOMED CT concept may have any number of synonyms, but there are the following special types:</p>
<ul>
<li>Fully Specified Name - this is the most precise description of the concept, but is too verbose for general use.</li>
<li>Preferred - these is the synonym that is preferred for clinical display in a particular language, and is recorded in the language-specific reference set</li>
</ul>
<p>Each concept also has a semantic tag, which denotes what type of concept it is (e.g. ‘disorder’ or ‘organism’). This is currently recorded in parentheses at the end of the Fully Specified Name, and can be extracted using the semanticType function in this package.</p>
</div>
<div id="loading-the-snomed-ct-dictionaries" class="section level2">
<h2>Loading the SNOMED CT dictionaries</h2>
<p>This package contains functions to import a set of SNOMED CT release files which should be obtained from NHS Digital TRUD (<a href="https://isd.digital.nhs.uk/trud/user/guest/group/0/home" class="uri">https://isd.digital.nhs.uk/trud/user/guest/group/0/home</a>). The International and UK release files are provided in two separate downloads, and need to be combined to create the whole dictionary. This can be done using the loadSNOMED() function and specifying a vector of folder paths to load.</p>
<p>The SNOMED CT UK drug extension is available as a separate file and can (in theory) be added to the SNOMED environment, but this has not yet been tested.</p>
<p>For most users the ‘Snapshot’ files, containing the current versions of the entries, will be the most useful, and these are loaded by loadSNOMED() function. The sample dictionaries in this package are also based on the Snapshot file format. The ‘Delta’ files contain changes since the previous version, and the ‘Full’ files contain a history of the changes to each entry.</p>
<p>When the NHS Digital SNOMED CT files are extracted, they will be in a folder such as ‘SnomedCT_InternationalRF2_PRODUCTION_20200731T120000Z’, and the relevant tables will be in the subfolder ‘Snapshot/Terminology’ (main SNOMED CT tables) and ‘Snapshot/Refset’ (mappings and refsets). Code such as the following can be used to load the tables into R (the file paths should be changed to the actual file paths on your system).</p>
<p>Note that the UK SNOMED CT release needs to be loaded together with the corresponding international release. The UK release cannot be used in isolation because it is incomplete.</p>
<pre><code># Load packages
library(Rdiagnosislist)
library(data.table)

# Load UK and International SNOMED CT release files into an
# R environment called &#39;SNOMED&#39;
SNOMED &lt;- loadSNOMED(c(
  &#39;SnomedCT_InternationalRF2_PRODUCTION_20200731T120000Z/&#39;,
  &#39;SnomedCT_UKClinicalRF2_PRODUCTION_20210317T000001Z/&#39;))

# Save the &#39;SNOMED&#39; environment to a file on disk
saveRDS(SNOMED, file = &#39;mySNOMED.RDS&#39;)

# Reload the &#39;SNOMED&#39; environment from file
SNOMED &lt;- readRDS(&#39;mySNOMED.RDS&#39;)</code></pre>
</div>
<div id="using-r-environments" class="section level2">
<h2>Using R environments</h2>
<p>The SNOMED CT dictionary files are loaded into an R ‘environment’, which is an object that can contain other objects. This is a convenient way in R to store a group of objects without cluttering up the global environment with too many individual objects. It also allows different versions of SNOMED CT dictionaries to be used side by side, by loading them into different environments. For ease of use, many of the functions in the package will search for the dictionaries in an environment named ‘SNOMED’ by default, but for programming use it is recommended to specify the environment explicitly in function calls to avoid unexpected errors.</p>
<p>For the purpose of this vignette, we will create a sample set of SNOMED CT files from the sample dictionaries included with the package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Load packages</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">require</span>(Rdiagnosislist)</a></code></pre></div>
<pre><code>## Loading required package: Rdiagnosislist</code></pre>
<pre><code>## Loading required package: readxl</code></pre>
<pre><code>## 
## Attaching package: &#39;Rdiagnosislist&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     decompose</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">require</span>(data.table)</a></code></pre></div>
<pre><code>## Loading required package: data.table</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Use one thread only for CRAN</span></a>
<a class="sourceLine" id="cb10-2" title="2">data.table<span class="op">::</span><span class="kw">setDTthreads</span>(<span class="dt">threads =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co"># The sampleSNOMED() function returns an environment containing</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co"># the sample dictionaries</span></a>
<a class="sourceLine" id="cb10-6" title="6">TEST &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co"># </span><span class="al">TEST</span><span class="co"> is now an environment containing the sample SNOMED CT dictionary.</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co"># Objects within the environment can be retrieved using the $ operator</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co"># or the &#39;get&#39; function. We will export the sample dictionaries to a</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co"># temporary folder to show how to reload them using loadSNOMED()</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">exportSNOMEDenvir</span>(TEST, <span class="kw">tempdir</span>())</a></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">dir</span>(<span class="kw">tempdir</span>())</a></code></pre></div>
<pre><code>## [1] &quot;HistorySubstitutionTable_Concepts.txt&quot;
## [2] &quot;Refset_ExtendedMapSnapshot.txt&quot;       
## [3] &quot;Refset_SimpleMapSnapshot.txt&quot;         
## [4] &quot;Refset_SimpleSnapshot.txt&quot;            
## [5] &quot;SNOMEDQueryTable.txt&quot;                 
## [6] &quot;_Concept_Snapshot.txt&quot;                
## [7] &quot;_Description_Snapshot.txt&quot;            
## [8] &quot;_Relationship_Snapshot.txt&quot;           
## [9] &quot;_StatedRelationship_Snapshot.txt&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># loadSNOMED searches for files containing &#39;_Concept_&#39;, &#39;_Description_&#39;,</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co"># &#39;_StatedRelationship_&#39;, &#39;_Relationship_&#39;, &#39;Refset_SimpleMap&#39;,</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co"># &#39;Refset_ExtendedMap&#39; or &#39;Refset_Simple&#39;, as in the actual SNOMED CT</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co"># release files.</span></a>
<a class="sourceLine" id="cb14-5" title="5"></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co"># Import using the loadSNOMED function</span></a>
<a class="sourceLine" id="cb14-7" title="7">SNOMED &lt;-<span class="st"> </span><span class="kw">loadSNOMED</span>(<span class="kw">tempdir</span>(), <span class="dt">active_only =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## Attempting to load from /tmp/Rtmp6S6wNy</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/_Concept_Snapshot.txt</code></pre>
<pre><code>##   Loaded 509 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Converting active to logical.</code></pre>
<pre><code>##   Naming as CONCEPT</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/_Description_Snapshot.txt</code></pre>
<pre><code>##   Loaded 1596 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Converting active to logical.</code></pre>
<pre><code>##   Naming as DESCRIPTION</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/_StatedRelationship_Snapshot.txt</code></pre>
<pre><code>##   Loaded 329 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Converting typeId to integer64.</code></pre>
<pre><code>##   Converting active to logical.</code></pre>
<pre><code>##   Naming as STATEDRELATIONSHIP</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/_Relationship_Snapshot.txt</code></pre>
<pre><code>##   Loaded 1915 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Converting typeId to integer64.</code></pre>
<pre><code>##   Converting active to logical.</code></pre>
<pre><code>##   Naming as RELATIONSHIP</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/Refset_SimpleMapSnapshot.txt</code></pre>
<pre><code>##   Loaded 124 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Naming as SIMPLEMAP</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/Refset_ExtendedMapSnapshot.txt</code></pre>
<pre><code>##   Loaded 915 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Converting mapCategoryId to integer64.</code></pre>
<pre><code>##   Converting active to logical.</code></pre>
<pre><code>##   Naming as EXTENDEDMAP</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/Refset_SimpleSnapshot.txt</code></pre>
<pre><code>##   Loaded 428 rows.</code></pre>
<pre><code>##   Converted effectiveTime to IDate.</code></pre>
<pre><code>##   Converting active to logical.</code></pre>
<pre><code>##   Naming as REFSET</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/SNOMEDQueryTable.txt</code></pre>
<pre><code>##   Loaded 1767 rows.</code></pre>
<pre><code>##   Converting supertypeId to integer64.</code></pre>
<pre><code>##   Naming as QUERY</code></pre>
<pre><code>## Attempting to load /tmp/Rtmp6S6wNy/HistorySubstitutionTable_Concepts.txt</code></pre>
<pre><code>##   Loaded 199 rows.</code></pre>
<pre><code>##   Naming as HISTORY</code></pre>
<pre><code>## 
## SNOMED CT tables loaded into environment:
##                  NAME NROW NCOL MB
## 1:            CONCEPT  509    5  0
## 2:        DESCRIPTION 1596    9  0
## 3:        EXTENDEDMAP  915   12  0
## 4:            HISTORY  199   14  0
## 5:              QUERY 1767    3  0
## 6:             REFSET  428    5  0
## 7:       RELATIONSHIP 1915   10  0
## 8:          SIMPLEMAP  124    6  0
## 9: STATEDRELATIONSHIP  329   10  0
##                                                                                COLS
## 1:                              id,effectiveTime,active,moduleId,definitionStatusId
## 2:                      id,effectiveTime,active,moduleId,conceptId,languageCode,...
## 3:        effectiveTime,active,moduleId,refsetId,referencedComponentId,mapGroup,...
## 4: OLDCONCEPTID,OLDCONCEPTSTATUS,NEWCONCEPTID,NEWCONCEPTSTATUS,PATH,ISAMBIGUOUS,...
## 5:                                                 supertypeId,subtypeId,provenance
## 6:                     effectiveTime,active,moduleId,refsetId,referencedComponentId
## 7:                      id,effectiveTime,active,moduleId,sourceId,destinationId,...
## 8:           effectiveTime,active,moduleId,refsetId,referencedComponentId,mapTarget
## 9:                      id,effectiveTime,active,moduleId,sourceId,destinationId,...
##                                                         KEY
## 1:                                                       id
## 2:                                                       id
## 3: mapPriority,mapCategoryId,refsetId,referencedComponentId
## 4:                                NEWCONCEPTID,OLDCONCEPTID
## 5:                                    supertypeId,subtypeId
## 6:                           refsetId,referencedComponentId
## 7:                                   sourceId,typeId,active
## 8:                 refsetId,mapTarget,referencedComponentId
## 9:                                   sourceId,typeId,active
## Total: 0MB using type_size</code></pre>
</div>
<div id="snomed-ct-concepts-ids-in-r" class="section level2">
<h2>SNOMED CT concepts IDs in R</h2>
<p>SNOMED CT concept IDs are long integers which need to be represented using the integer64 data type in R. This is not available in base R but is provided in the bit64 package which is automatically loaded with this package. They must not be stored as short integer or numeric values because they cannot be stored precisely and may be incorrect.</p>
<p>This package makes it easier to use SNOMED CT concept IDs because they can be supplied as character vectors and converted to ‘SNOMEDconcept’ vectors. The SNOMEDconcept class is a 64-bit integer class which can faithfully store SNOMED CT concept IDs, and is more memory-efficient than storing them as character vectors. If the SNOMED dictionary is available in the R environment, the concepts are displayed with their description in the default print method.</p>
<p>The function ‘as.SNOMEDconcept’ can be used to retrieve the SNOMED concept ID matching a description. This function also converts SNOMED CT concept IDs in other formats (numeric, 64-bit integer or character) into SNOMEDconcept objects.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># Make sure the SNOMED environment is available and contains the SNOMED dictionary</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>, <span class="dt">SNOMED =</span> SNOMED)</a></code></pre></div>
<pre><code>## [1] &quot;84114007 | Heart failure (disorder)&quot;</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># To use the sample SNOMED dictionary for testing</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>, <span class="dt">SNOMED =</span> <span class="kw">sampleSNOMED</span>())</a></code></pre></div>
<pre><code>## [1] &quot;84114007 | Heart failure (disorder)&quot;</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># If an object named SNOMED containing the SNOMED dictionary is available</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="co"># in the current environment, it does not need to be stated in the</span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="co"># function call</span></a>
<a class="sourceLine" id="cb65-4" title="4">SNOMED &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb65-5" title="5"><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;84114007 | Heart failure (disorder)&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co"># The argument &#39;exact&#39; can be used to specify whether a regular expression</span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="co"># search should be done, e.g.</span></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart f&#39;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;5053004 | Cardiac insufficiency due to prosthesis (disorder)&quot;             
##  [2] &quot;60856006 | Cardiac insufficiency following cardiac surgery (disorder)&quot;    
##  [3] &quot;84114007 | Heart failure (disorder)&quot;                                      
##  [4] &quot;89819002 | Cardiac insufficiency during AND/OR resulting from a proced...&quot;
##  [5] &quot;233924009 | Heart failure as a complication of care (disorder)&quot;           
##  [6] &quot;309634009 | History of heart failure in last year (situation)&quot;            
##  [7] &quot;390868005 | Heart failure screen (procedure)&quot;                             
##  [8] &quot;394927007 | Heart failure excluded (situation)&quot;                           
##  [9] &quot;395105005 | Heart failure confirmed (situation)&quot;                          
## [10] &quot;423475008 | Heart failure education (procedure)&quot;                          
## [11] &quot;446221000 | Heart failure with normal ejection fraction (disorder)&quot;       
## [12] &quot;471880001 | Heart failure due to end stage congenital heart disease (d...&quot;
## [13] &quot;703276005 | Heart failure with reduced ejection fraction due to heart ...&quot;
## [14] &quot;703275009 | Heart failure with reduced ejection fraction due to cardio...&quot;
## [15] &quot;703273002 | Heart failure with reduced ejection fraction due to corona...&quot;
## [16] &quot;703272007 | Heart failure with reduced ejection fraction (disorder)&quot;      
## [17] &quot;703274008 | Heart failure with reduced ejection fraction due to myocar...&quot;
## [18] &quot;788950000 | Heart failure with mid range ejection fraction (disorder)&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># The &#39;description&#39; function can be used to return the descriptions of</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co"># the concepts found. It returns a data.table with the fully specified </span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="co"># name for each term.</span></a>
<a class="sourceLine" id="cb69-4" title="4"><span class="kw">description</span>(<span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart f&#39;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>##             id       conceptId
##          &lt;i64&gt; &lt;SNOMEDconcept&gt;
##  1:  788329019         5053004
##  2:  799854016        60856006
##  3:  825890014        84114007
##  4:  832792011        89819002
##  5:  622176015       233924009
##  6: 2987039012       309634009
##  7: 1465046015       390868005
##  8: 2612836016       394927007
##  9: 2612834018       395105005
## 10: 2641521019       423475008
## 11: 2881211010       446221000
## 12: 2950980013       471880001
## 13: 3008127011       703276005
## 14: 3008129014       703275009
## 15: 3008172015       703273002
## 16: 3008153015       703272007
## 17: 3008310010       703274008
## 18: 3786233013       788950000
##                                                                                       term
##                                                                                     &lt;char&gt;
##  1:                                     Cardiac insufficiency due to prosthesis (disorder)
##  2:                             Cardiac insufficiency following cardiac surgery (disorder)
##  3:                                                               Heart failure (disorder)
##  4:              Cardiac insufficiency during AND/OR resulting from a procedure (disorder)
##  5:                                     Heart failure as a complication of care (disorder)
##  6:                                      History of heart failure in last year (situation)
##  7:                                                       Heart failure screen (procedure)
##  8:                                                     Heart failure excluded (situation)
##  9:                                                    Heart failure confirmed (situation)
## 10:                                                    Heart failure education (procedure)
## 11:                                 Heart failure with normal ejection fraction (disorder)
## 12:                     Heart failure due to end stage congenital heart disease (disorder)
## 13:     Heart failure with reduced ejection fraction due to heart valve disease (disorder)
## 14:          Heart failure with reduced ejection fraction due to cardiomyopathy (disorder)
## 15: Heart failure with reduced ejection fraction due to coronary artery disease (disorder)
## 16:                                Heart failure with reduced ejection fraction (disorder)
## 17:             Heart failure with reduced ejection fraction due to myocarditis (disorder)
## 18:                              Heart failure with mid range ejection fraction (disorder)</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># The &#39;semantic type&#39; function returns the semantic type of the concept</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="co"># from the Fully Specified Name</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw">semanticType</span>(<span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;disorder&quot;</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co"># Functions which expect a SNOMEDconcept object, such as semanticType,</span></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="co"># will automatically convert their argument to SNOMEDconcept using the</span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co"># function as.SNOMEDconcept</span></a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">semanticType</span>(<span class="st">&#39;Heart failure&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;disorder&quot;</code></pre>
</div>
<div id="set-operations-using-snomedconcept" class="section level2">
<h2>Set operations using SNOMEDconcept</h2>
<p>This package provides versions of the set functions ‘setdiff’, ‘intersect’ and ‘union’ which work with SNOMEDconcept objects.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="co"># A list of concepts with a description containing the term &#39;heart&#39;</span></a>
<a class="sourceLine" id="cb75-2" title="2"><span class="co"># (not that all synonyms are searched, not just the Fully Specified Names)</span></a>
<a class="sourceLine" id="cb75-3" title="3">heart &lt;-<span class="st"> </span><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart|heart&#39;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>, <span class="dt">SNOMED =</span> <span class="kw">sampleSNOMED</span>())</a>
<a class="sourceLine" id="cb75-4" title="4"></a>
<a class="sourceLine" id="cb75-5" title="5"><span class="co"># A list of concepts containing the term &#39;fail&#39;</span></a>
<a class="sourceLine" id="cb75-6" title="6">fail &lt;-<span class="st"> </span><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Fail|fail&#39;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>, <span class="dt">SNOMED =</span> <span class="kw">sampleSNOMED</span>())</a>
<a class="sourceLine" id="cb75-7" title="7"></a>
<a class="sourceLine" id="cb75-8" title="8"><span class="co"># Concepts with heart and fail</span></a>
<a class="sourceLine" id="cb75-9" title="9"><span class="kw">intersect</span>(heart, fail)</a></code></pre></div>
<pre><code>##  [1] &quot;364006 | Acute left-sided heart failure (disorder)&quot;                       
##  [2] &quot;5053004 | Cardiac insufficiency due to prosthesis (disorder)&quot;             
##  [3] &quot;5148006 | Hypertensive heart disease with congestive heart failure (di...&quot;
##  [4] &quot;5375005 | Chronic left-sided congestive heart failure (disorder)&quot;         
##  [5] &quot;10091002 | High output heart failure (disorder)&quot;                          
##  [6] &quot;10335000 | Chronic right-sided heart failure (disorder)&quot;                  
##  [7] &quot;10633002 | Acute congestive heart failure (disorder)&quot;                     
##  [8] &quot;25544003 | Low output heart failure (disorder)&quot;                           
##  [9] &quot;42343007 | Congestive heart failure (disorder)&quot;                           
## [10] &quot;44313006 | Right heart failure secondary to left heart failure (disorder)&quot;
## [11] &quot;46113002 | Hypertensive heart failure (disorder)&quot;                         
## [12] &quot;48447003 | Chronic heart failure (disorder)&quot;                              
## [13] &quot;56675007 | Acute heart failure (disorder)&quot;                                
## [14] &quot;60856006 | Cardiac insufficiency following cardiac surgery (disorder)&quot;    
## [15] &quot;66989003 | Chronic right-sided congestive heart failure (disorder)&quot;       
## [16] &quot;74960003 | Acute left-sided congestive heart failure (disorder)&quot;          
## [17] &quot;80479009 | Acute right-sided congestive heart failure (disorder)&quot;         
## [18] &quot;82523003 | Congestive rheumatic heart failure (disorder)&quot;                 
## [19] &quot;83105008 | Malignant hypertensive heart disease with congestive heart ...&quot;
## [20] &quot;84114007 | Heart failure (disorder)&quot;                                      
## [21] &quot;85232009 | Left heart failure (disorder)&quot;                                 
## [22] &quot;88805009 | Chronic congestive heart failure (disorder)&quot;                   
## [23] &quot;89819002 | Cardiac insufficiency during AND/OR resulting from a proced...&quot;
## [24] &quot;90727007 | Pleural effusion due to congestive heart failure (disorder)&quot;   
## [25] &quot;92506005 | Biventricular congestive heart failure (disorder)&quot;             
## [26] &quot;111283005 | Chronic left-sided heart failure (disorder)&quot;                  
## [27] &quot;161505003 | History of heart failure (situation)&quot;                         
## [28] &quot;194767001 | Benign hypertensive heart disease with congestive cardiac ...&quot;
## [29] &quot;194779001 | Hypertensive heart and renal disease with (congestive) hea...&quot;
## [30] &quot;194781004 | Hypertensive heart and renal disease with both (congestive...&quot;
## [31] &quot;233924009 | Heart failure as a complication of care (disorder)&quot;           
## [32] &quot;309634009 | History of heart failure in last year (situation)&quot;            
## [33] &quot;314206003 | Refractory heart failure (disorder)&quot;                          
## [34] &quot;359617009 | Acute right-sided heart failure (disorder)&quot;                   
## [35] &quot;390868005 | Heart failure screen (procedure)&quot;                             
## [36] &quot;394887005 | Suspected heart failure (situation)&quot;                          
## [37] &quot;394927007 | Heart failure excluded (situation)&quot;                           
## [38] &quot;395105005 | Heart failure confirmed (situation)&quot;                          
## [39] &quot;418304008 | Diastolic heart failure (disorder)&quot;                           
## [40] &quot;417996009 | Systolic heart failure (disorder)&quot;                            
## [41] &quot;424404003 | Decompensated chronic heart failure (disorder)&quot;               
## [42] &quot;423475008 | Heart failure education (procedure)&quot;                          
## [43] &quot;426611007 | Congestive heart failure due to valvular disease (disorder)&quot;  
## [44] &quot;426263006 | Congestive heart failure due to left ventricular systolic ...&quot;
## [45] &quot;426012001 | Right heart failure due to pulmonary hypertension (disorder)&quot; 
## [46] &quot;429959009 | Family history of heart failure (situation)&quot;                  
## [47] &quot;433305001 | Family history of congestive heart failure (situation)&quot;       
## [48] &quot;441481004 | Chronic systolic heart failure (disorder)&quot;                    
## [49] &quot;441530006 | Chronic diastolic heart failure (disorder)&quot;                   
## [50] &quot;443253003 | Acute on chronic systolic heart failure (disorder)&quot;           
## [51] &quot;443254009 | Acute systolic heart failure (disorder)&quot;                      
## [52] &quot;443343001 | Acute diastolic heart failure (disorder)&quot;                     
## [53] &quot;443344007 | Acute on chronic diastolic heart failure (disorder)&quot;          
## [54] &quot;446221000 | Heart failure with normal ejection fraction (disorder)&quot;       
## [55] &quot;96311000119109 | Exacerbation of congestive heart failure (disorder)&quot;     
## [56] &quot;120851000119104 | Systolic heart failure stage D (disorder)&quot;              
## [57] &quot;120861000119102 | Systolic heart failure stage C (disorder)&quot;              
## [58] &quot;120891000119109 | Diastolic heart failure stage C (disorder)&quot;             
## [59] &quot;120881000119106 | Diastolic heart failure stage D (disorder)&quot;             
## [60] &quot;67431000119105 | Congestive heart failure stage D (disorder)&quot;             
## [61] &quot;67441000119101 | Congestive heart failure stage C (disorder)&quot;             
## [62] &quot;462175008 | Fetal heart failure with redistribution of cardiac output ...&quot;
## [63] &quot;462174007 | Fetal heart failure with myocardial hypertrophy (disorder)&quot;   
## [64] &quot;462172006 | Fetal heart failure (disorder)&quot;                               
## [65] &quot;471880001 | Heart failure due to end stage congenital heart disease (d...&quot;
## [66] &quot;83291003 | Cor pulmonale (disorder)&quot;                                      
## [67] &quot;153931000119109 | Acute combined systolic and diastolic heart failure ...&quot;
## [68] &quot;101281000119107 | Congestive heart failure due to cardiomyopathy (diso...&quot;
## [69] &quot;698296002 | Acute exacerbation of chronic congestive heart failure (di...&quot;
## [70] &quot;698594003 | Symptomatic congestive heart failure (disorder)&quot;              
## [71] &quot;153951000119103 | Acute on chronic combined systolic and diastolic hea...&quot;
## [72] &quot;23341000119109 | Congestive heart failure with right heart failure (di...&quot;
## [73] &quot;153941000119100 | Chronic combined systolic and diastolic heart failur...&quot;
## [74] &quot;72481000119103 | Congestive heart failure as early postoperative compl...&quot;
## [75] &quot;15781000119107 | Hypertensive heart AND chronic kidney disease with co...&quot;
## [76] &quot;703276005 | Heart failure with reduced ejection fraction due to heart ...&quot;
## [77] &quot;703275009 | Heart failure with reduced ejection fraction due to cardio...&quot;
## [78] &quot;703273002 | Heart failure with reduced ejection fraction due to corona...&quot;
## [79] &quot;703272007 | Heart failure with reduced ejection fraction (disorder)&quot;      
## [80] &quot;703274008 | Heart failure with reduced ejection fraction due to myocar...&quot;
## [81] &quot;704242009 | Fetal heart failure due to extracardiac disease (disorder)&quot;   
## [82] &quot;15629741000119102 | Systolic heart failure stage C due to ischemic car...&quot;
## [83] &quot;718287008 | Provision of written information about heart failure (proc...&quot;
## [84] &quot;15629591000119103 | Congestive heart failure stage B due to ischemic c...&quot;
## [85] &quot;15629541000119106 | Congestive heart failure stage C due to ischemic c...&quot;
## [86] &quot;717840005 | Congestive heart failure stage B (disorder)&quot;                  
## [87] &quot;788950000 | Heart failure with mid range ejection fraction (disorder)&quot;    
## [88] &quot;16838951000119100 | Acute on chronic right-sided congestive heart fail...&quot;
## [89] &quot;367363000 | Right ventricular failure (disorder)&quot;                         
## [90] &quot;871617000 | Low output heart failure due to and following Fontan opera...&quot;
## [91] &quot;813991000000101 | Education about deteriorating heart failure (procedure)&quot;</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># Concepts with heart and not fail</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">setdiff</span>(heart, fail)</a></code></pre></div>
<pre><code>##  [1] &quot;127337006 | Acute heart disease (disorder)&quot;                               
##  [2] &quot;368009 | Heart valve disorder (disorder)&quot;                                 
##  [3] &quot;13213009 | Congenital heart disease (disorder)&quot;                           
##  [4] &quot;23685000 | Rheumatic heart disease (disorder)&quot;                            
##  [5] &quot;36221001 | Benign hypertensive heart disease (disorder)&quot;                  
##  [6] &quot;54225002 | Malignant hypertensive heart disease (disorder)&quot;               
##  [7] &quot;56265001 | Heart disease (disorder)&quot;                                      
##  [8] &quot;64715009 | Hypertensive heart disease (disorder)&quot;                         
##  [9] &quot;64915003 | Operation on heart (procedure)&quot;                                
## [10] &quot;66816004 | Implantation of cardiac temporary transvenous pacemaker sys...&quot;
## [11] &quot;67189007 | Acute pulmonary heart disease (disorder)&quot;                      
## [12] &quot;79561009 | Structure of right side of heart (body structure)&quot;             
## [13] &quot;80891009 | Heart structure (body structure)&quot;                              
## [14] &quot;86234004 | Hypertensive heart AND renal disease (disorder)&quot;               
## [15] &quot;87837008 | Chronic pulmonary heart disease (disorder)&quot;                    
## [16] &quot;118797008 | Procedure on heart (procedure)&quot;                               
## [17] &quot;119202000 | Heart part (body structure)&quot;                                  
## [18] &quot;128238001 | Chronic heart disease (disorder)&quot;                             
## [19] &quot;128599005 | Structural disorder of heart (disorder)&quot;                      
## [20] &quot;301095005 | Cardiac finding (finding)&quot;                                    
## [21] &quot;57809008 | Myocardial disease (disorder)&quot;                                 
## [22] &quot;409708007 | Heart and/or pericardium structure (body structure)&quot;          
## [23] &quot;307280005 | Implantation of cardiac pacemaker (procedure)&quot;                
## [24] &quot;430901004 | Fetal heart disorder (disorder)&quot;                              
## [25] &quot;473383000 | Abnormality of fetal heart (disorder)&quot;                        
## [26] &quot;87878005 | Left cardiac ventricular structure (body structure)&quot;           
## [27] &quot;53085002 | Right cardiac ventricular structure (body structure)&quot;          
## [28] &quot;82327001 | Cardiac fluoroscopy (procedure)&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># Concepts with heart or fail</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">union</span>(heart, fail)</a></code></pre></div>
<pre><code>##   [1] &quot;127337006 | Acute heart disease (disorder)&quot;                               
##   [2] &quot;364006 | Acute left-sided heart failure (disorder)&quot;                       
##   [3] &quot;368009 | Heart valve disorder (disorder)&quot;                                 
##   [4] &quot;5053004 | Cardiac insufficiency due to prosthesis (disorder)&quot;             
##   [5] &quot;5148006 | Hypertensive heart disease with congestive heart failure (di...&quot;
##   [6] &quot;5375005 | Chronic left-sided congestive heart failure (disorder)&quot;         
##   [7] &quot;10091002 | High output heart failure (disorder)&quot;                          
##   [8] &quot;10335000 | Chronic right-sided heart failure (disorder)&quot;                  
##   [9] &quot;10633002 | Acute congestive heart failure (disorder)&quot;                     
##  [10] &quot;13213009 | Congenital heart disease (disorder)&quot;                           
##  [11] &quot;23685000 | Rheumatic heart disease (disorder)&quot;                            
##  [12] &quot;25544003 | Low output heart failure (disorder)&quot;                           
##  [13] &quot;36221001 | Benign hypertensive heart disease (disorder)&quot;                  
##  [14] &quot;42343007 | Congestive heart failure (disorder)&quot;                           
##  [15] &quot;44313006 | Right heart failure secondary to left heart failure (disorder)&quot;
##  [16] &quot;46113002 | Hypertensive heart failure (disorder)&quot;                         
##  [17] &quot;48447003 | Chronic heart failure (disorder)&quot;                              
##  [18] &quot;54225002 | Malignant hypertensive heart disease (disorder)&quot;               
##  [19] &quot;56265001 | Heart disease (disorder)&quot;                                      
##  [20] &quot;56675007 | Acute heart failure (disorder)&quot;                                
##  [21] &quot;60856006 | Cardiac insufficiency following cardiac surgery (disorder)&quot;    
##  [22] &quot;64715009 | Hypertensive heart disease (disorder)&quot;                         
##  [23] &quot;64915003 | Operation on heart (procedure)&quot;                                
##  [24] &quot;66816004 | Implantation of cardiac temporary transvenous pacemaker sys...&quot;
##  [25] &quot;66989003 | Chronic right-sided congestive heart failure (disorder)&quot;       
##  [26] &quot;67189007 | Acute pulmonary heart disease (disorder)&quot;                      
##  [27] &quot;74960003 | Acute left-sided congestive heart failure (disorder)&quot;          
##  [28] &quot;79561009 | Structure of right side of heart (body structure)&quot;             
##  [29] &quot;80479009 | Acute right-sided congestive heart failure (disorder)&quot;         
##  [30] &quot;80891009 | Heart structure (body structure)&quot;                              
##  [31] &quot;82523003 | Congestive rheumatic heart failure (disorder)&quot;                 
##  [32] &quot;83105008 | Malignant hypertensive heart disease with congestive heart ...&quot;
##  [33] &quot;84114007 | Heart failure (disorder)&quot;                                      
##  [34] &quot;85232009 | Left heart failure (disorder)&quot;                                 
##  [35] &quot;86234004 | Hypertensive heart AND renal disease (disorder)&quot;               
##  [36] &quot;87837008 | Chronic pulmonary heart disease (disorder)&quot;                    
##  [37] &quot;88805009 | Chronic congestive heart failure (disorder)&quot;                   
##  [38] &quot;89819002 | Cardiac insufficiency during AND/OR resulting from a proced...&quot;
##  [39] &quot;90727007 | Pleural effusion due to congestive heart failure (disorder)&quot;   
##  [40] &quot;92506005 | Biventricular congestive heart failure (disorder)&quot;             
##  [41] &quot;111283005 | Chronic left-sided heart failure (disorder)&quot;                  
##  [42] &quot;118797008 | Procedure on heart (procedure)&quot;                               
##  [43] &quot;119202000 | Heart part (body structure)&quot;                                  
##  [44] &quot;128238001 | Chronic heart disease (disorder)&quot;                             
##  [45] &quot;128599005 | Structural disorder of heart (disorder)&quot;                      
##  [46] &quot;161505003 | History of heart failure (situation)&quot;                         
##  [47] &quot;194767001 | Benign hypertensive heart disease with congestive cardiac ...&quot;
##  [48] &quot;194779001 | Hypertensive heart and renal disease with (congestive) hea...&quot;
##  [49] &quot;194781004 | Hypertensive heart and renal disease with both (congestive...&quot;
##  [50] &quot;233924009 | Heart failure as a complication of care (disorder)&quot;           
##  [51] &quot;301095005 | Cardiac finding (finding)&quot;                                    
##  [52] &quot;309634009 | History of heart failure in last year (situation)&quot;            
##  [53] &quot;314206003 | Refractory heart failure (disorder)&quot;                          
##  [54] &quot;359617009 | Acute right-sided heart failure (disorder)&quot;                   
##  [55] &quot;57809008 | Myocardial disease (disorder)&quot;                                 
##  [56] &quot;390868005 | Heart failure screen (procedure)&quot;                             
##  [57] &quot;394887005 | Suspected heart failure (situation)&quot;                          
##  [58] &quot;394927007 | Heart failure excluded (situation)&quot;                           
##  [59] &quot;395105005 | Heart failure confirmed (situation)&quot;                          
##  [60] &quot;409708007 | Heart and/or pericardium structure (body structure)&quot;          
##  [61] &quot;307280005 | Implantation of cardiac pacemaker (procedure)&quot;                
##  [62] &quot;418304008 | Diastolic heart failure (disorder)&quot;                           
##  [63] &quot;417996009 | Systolic heart failure (disorder)&quot;                            
##  [64] &quot;424404003 | Decompensated chronic heart failure (disorder)&quot;               
##  [65] &quot;423475008 | Heart failure education (procedure)&quot;                          
##  [66] &quot;426611007 | Congestive heart failure due to valvular disease (disorder)&quot;  
##  [67] &quot;426263006 | Congestive heart failure due to left ventricular systolic ...&quot;
##  [68] &quot;426012001 | Right heart failure due to pulmonary hypertension (disorder)&quot; 
##  [69] &quot;429959009 | Family history of heart failure (situation)&quot;                  
##  [70] &quot;433305001 | Family history of congestive heart failure (situation)&quot;       
##  [71] &quot;430901004 | Fetal heart disorder (disorder)&quot;                              
##  [72] &quot;441481004 | Chronic systolic heart failure (disorder)&quot;                    
##  [73] &quot;441530006 | Chronic diastolic heart failure (disorder)&quot;                   
##  [74] &quot;443253003 | Acute on chronic systolic heart failure (disorder)&quot;           
##  [75] &quot;443254009 | Acute systolic heart failure (disorder)&quot;                      
##  [76] &quot;443343001 | Acute diastolic heart failure (disorder)&quot;                     
##  [77] &quot;443344007 | Acute on chronic diastolic heart failure (disorder)&quot;          
##  [78] &quot;446221000 | Heart failure with normal ejection fraction (disorder)&quot;       
##  [79] &quot;96311000119109 | Exacerbation of congestive heart failure (disorder)&quot;     
##  [80] &quot;120851000119104 | Systolic heart failure stage D (disorder)&quot;              
##  [81] &quot;120861000119102 | Systolic heart failure stage C (disorder)&quot;              
##  [82] &quot;120891000119109 | Diastolic heart failure stage C (disorder)&quot;             
##  [83] &quot;120881000119106 | Diastolic heart failure stage D (disorder)&quot;             
##  [84] &quot;67431000119105 | Congestive heart failure stage D (disorder)&quot;             
##  [85] &quot;67441000119101 | Congestive heart failure stage C (disorder)&quot;             
##  [86] &quot;462175008 | Fetal heart failure with redistribution of cardiac output ...&quot;
##  [87] &quot;462174007 | Fetal heart failure with myocardial hypertrophy (disorder)&quot;   
##  [88] &quot;462172006 | Fetal heart failure (disorder)&quot;                               
##  [89] &quot;471880001 | Heart failure due to end stage congenital heart disease (d...&quot;
##  [90] &quot;83291003 | Cor pulmonale (disorder)&quot;                                      
##  [91] &quot;473383000 | Abnormality of fetal heart (disorder)&quot;                        
##  [92] &quot;153931000119109 | Acute combined systolic and diastolic heart failure ...&quot;
##  [93] &quot;101281000119107 | Congestive heart failure due to cardiomyopathy (diso...&quot;
##  [94] &quot;698296002 | Acute exacerbation of chronic congestive heart failure (di...&quot;
##  [95] &quot;698594003 | Symptomatic congestive heart failure (disorder)&quot;              
##  [96] &quot;153951000119103 | Acute on chronic combined systolic and diastolic hea...&quot;
##  [97] &quot;23341000119109 | Congestive heart failure with right heart failure (di...&quot;
##  [98] &quot;153941000119100 | Chronic combined systolic and diastolic heart failur...&quot;
##  [99] &quot;72481000119103 | Congestive heart failure as early postoperative compl...&quot;
## [100] &quot;15781000119107 | Hypertensive heart AND chronic kidney disease with co...&quot;
## [101] &quot;703276005 | Heart failure with reduced ejection fraction due to heart ...&quot;
## [102] &quot;703275009 | Heart failure with reduced ejection fraction due to cardio...&quot;
## [103] &quot;703273002 | Heart failure with reduced ejection fraction due to corona...&quot;
## [104] &quot;703272007 | Heart failure with reduced ejection fraction (disorder)&quot;      
## [105] &quot;703274008 | Heart failure with reduced ejection fraction due to myocar...&quot;
## [106] &quot;704242009 | Fetal heart failure due to extracardiac disease (disorder)&quot;   
## [107] &quot;15629741000119102 | Systolic heart failure stage C due to ischemic car...&quot;
## [108] &quot;718287008 | Provision of written information about heart failure (proc...&quot;
## [109] &quot;15629591000119103 | Congestive heart failure stage B due to ischemic c...&quot;
## [110] &quot;15629541000119106 | Congestive heart failure stage C due to ischemic c...&quot;
## [111] &quot;717840005 | Congestive heart failure stage B (disorder)&quot;                  
## [112] &quot;87878005 | Left cardiac ventricular structure (body structure)&quot;           
## [113] &quot;53085002 | Right cardiac ventricular structure (body structure)&quot;          
## [114] &quot;788950000 | Heart failure with mid range ejection fraction (disorder)&quot;    
## [115] &quot;16838951000119100 | Acute on chronic right-sided congestive heart fail...&quot;
## [116] &quot;367363000 | Right ventricular failure (disorder)&quot;                         
## [117] &quot;871617000 | Low output heart failure due to and following Fontan opera...&quot;
## [118] &quot;82327001 | Cardiac fluoroscopy (procedure)&quot;                               
## [119] &quot;813991000000101 | Education about deteriorating heart failure (procedure)&quot;
## [120] &quot;13839000 | Bernheim&#39;s syndrome (disorder)&quot;                                
## [121] &quot;14669001 | Acute renal failure syndrome (disorder)&quot;                       
## [122] &quot;42399005 | Renal failure syndrome (disorder)&quot;                             
## [123] &quot;43736008 | Rheumatic left ventricular failure (disorder)&quot;                 
## [124] &quot;49220004 | Hypertensive renal failure (disorder)&quot;                         
## [125] &quot;55565007 | Cardiac failure after obstetrical surgery AND/OR other proc...&quot;
## [126] &quot;195111005 | Decompensated cardiac failure (disorder)&quot;                     
## [127] &quot;195112003 | Compensated cardiac failure (disorder)&quot;                       
## [128] &quot;195114002 | Acute left ventricular failure (disorder)&quot;                    
## [129] &quot;206586007 | Congenital cardiac failure (disorder)&quot;                        
## [130] &quot;276514007 | Neonatal cardiac failure (disorder)&quot;                          
## [131] &quot;277638005 | Sepsis-associated left ventricular failure (disorder)&quot;        
## [132] &quot;277639002 | Sepsis-associated right ventricular failure (disorder)&quot;       
## [133] &quot;313389004 | No cardiac failure (situation)&quot;                               
## [134] &quot;409622000 | Respiratory failure (disorder)&quot;                               
## [135] &quot;410431009 | Cardiorespiratory failure (disorder)&quot;                         
## [136] &quot;609460008 | Induced termination of pregnancy complicated by cardiac ar...&quot;
## [137] &quot;609507007 | Induced termination of pregnancy complicated by cardiac fa...&quot;
## [138] &quot;722095005 | Acute kidney injury due to circulatory failure (disorder)&quot;    
## [139] &quot;722919003 | Neonatal cardiac failure due to decreased left ventricular...&quot;
## [140] &quot;724550005 | Neonatal cardiac failure due to pulmonary overperfusion (d...&quot;</code></pre>
<p>These set operations can be used to create lists of SNOMED CT concepts of interest, similar to the way researchers use Read codes. However, SNOMED CT also allows the use of hierarchies and relationships to locate concepts by their meaning.</p>
</div>
<div id="using-relationships-between-snomed-ct-concepts" class="section level2">
<h2>Using relationships between SNOMED CT concepts</h2>
<p>The most important relationship is the ‘Is a’ relationship, also known as parent and child. This makes it easy to find all specific concepts that are a subtype of a more general concept. The relationship functions (parents, ancestors, children and descendants) all take a SNOMEDconcept object as input, or attempt to convert their argument to SNOMEDconcept.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">SNOMED &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb81-2" title="2"></a>
<a class="sourceLine" id="cb81-3" title="3"><span class="co"># Parents (immediate ancestors)</span></a>
<a class="sourceLine" id="cb81-4" title="4"><span class="kw">parents</span>(<span class="st">&#39;Acute heart failure&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;84114007 | Heart failure (disorder)&quot;       
## [2] &quot;127337006 | Acute heart disease (disorder)&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co"># Ancestors</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">ancestors</span>(<span class="st">&#39;Acute heart failure&#39;</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;49483002 | Disorder of mediastinum (disorder)&quot;               
##  [2] &quot;49601007 | Disorder of cardiovascular system (disorder)&quot;     
##  [3] &quot;56265001 | Heart disease (disorder)&quot;                         
##  [4] &quot;64572001 | Disease (disorder)&quot;                               
##  [5] &quot;84114007 | Heart failure (disorder)&quot;                         
##  [6] &quot;105981003 | Disorder of cardiac function (disorder)&quot;         
##  [7] &quot;106063007 | Cardiovascular finding (finding)&quot;                
##  [8] &quot;118228005 | Functional finding (finding)&quot;                    
##  [9] &quot;118946009 | Disorder of thorax (disorder)&quot;                   
## [10] &quot;127337006 | Acute heart disease (disorder)&quot;                  
## [11] &quot;128121009 | Disorder of trunk (disorder)&quot;                    
## [12] &quot;298705000 | Finding of region of thorax (finding)&quot;           
## [13] &quot;301095005 | Cardiac finding (finding)&quot;                       
## [14] &quot;301296002 | Mediastinal finding (finding)&quot;                   
## [15] &quot;302292003 | Finding of trunk structure (finding)&quot;            
## [16] &quot;362965005 | Disorder of body system (disorder)&quot;              
## [17] &quot;404684003 | Clinical finding (finding)&quot;                      
## [18] &quot;406123005 | Viscus structure finding (finding)&quot;              
## [19] &quot;609622007 | Disorder of thoracic segment of trunk (disorder)&quot;
## [20] &quot;609623002 | Finding of upper trunk (finding)&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># Children (immediate descendants)</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">children</span>(<span class="st">&#39;Acute heart failure&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;364006 | Acute left-sided heart failure (disorder)&quot;                   
## [2] &quot;10633002 | Acute congestive heart failure (disorder)&quot;                 
## [3] &quot;49584005 | Acute cor pulmonale (disorder)&quot;                            
## [4] &quot;359617009 | Acute right-sided heart failure (disorder)&quot;               
## [5] &quot;443254009 | Acute systolic heart failure (disorder)&quot;                  
## [6] &quot;443343001 | Acute diastolic heart failure (disorder)&quot;                 
## [7] &quot;722095005 | Acute kidney injury due to circulatory failure (disorder)&quot;</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># Descendants</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">descendants</span>(<span class="st">&#39;Acute heart failure&#39;</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;364006 | Acute left-sided heart failure (disorder)&quot;                       
##  [2] &quot;10633002 | Acute congestive heart failure (disorder)&quot;                     
##  [3] &quot;49584005 | Acute cor pulmonale (disorder)&quot;                                
##  [4] &quot;74960003 | Acute left-sided congestive heart failure (disorder)&quot;          
##  [5] &quot;80479009 | Acute right-sided congestive heart failure (disorder)&quot;         
##  [6] &quot;359617009 | Acute right-sided heart failure (disorder)&quot;                   
##  [7] &quot;443253003 | Acute on chronic systolic heart failure (disorder)&quot;           
##  [8] &quot;443254009 | Acute systolic heart failure (disorder)&quot;                      
##  [9] &quot;443343001 | Acute diastolic heart failure (disorder)&quot;                     
## [10] &quot;443344007 | Acute on chronic diastolic heart failure (disorder)&quot;          
## [11] &quot;698296002 | Acute exacerbation of chronic congestive heart failure (di...&quot;
## [12] &quot;722095005 | Acute kidney injury due to circulatory failure (disorder)&quot;    
## [13] &quot;153931000119109 | Acute combined systolic and diastolic heart failure ...&quot;
## [14] &quot;153951000119103 | Acute on chronic combined systolic and diastolic hea...&quot;
## [15] &quot;15964701000119109 | Acute cor pulmonale co-occurrent and due to saddle...&quot;
## [16] &quot;16838951000119100 | Acute on chronic right-sided congestive heart fail...&quot;</code></pre>
</div>
<div id="attributes-of-snomed-ct-concepts" class="section level2">
<h2>Attributes of SNOMED CT concepts</h2>
<p>The ‘hasAttributes’ function can be used to find terms with particular attributes. For example, to find all disorders with a finding site of the heart, we can use the relatedConcepts function, which retrieves relationships from the RELATIONSHIP and STATEDRELATIONSHIP tables.</p>
<p>In order to find the finding site of a disorder, we use the ‘forward’ relationship. In order to find disorders with a particular finding site, we use the relationship in the ‘reverse’ direction.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">SNOMED &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb89-2" title="2"></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="co"># List all the attributes of a concept</span></a>
<a class="sourceLine" id="cb89-4" title="4"><span class="kw">print</span>(<span class="kw">attrConcept</span>(<span class="st">&#39;Heart failure&#39;</span>))</a></code></pre></div>
<pre><code>##            sourceId destinationId    typeId relationshipGroup active
##     &lt;SNOMEDconcept&gt;         &lt;i64&gt;     &lt;i64&gt;             &lt;int&gt; &lt;lgcl&gt;
##  1:        84114007     105981003 116680003                 0   TRUE
##  2:        84114007      80891009 363698007                 1   TRUE
##  3:        84114007     260379002 363713009                 2   TRUE
##  4:        10091002      84114007 116680003                 0   TRUE
##  5:        25544003      84114007 116680003                 0   TRUE
##  6:        42343007      84114007 116680003                 0   TRUE
##  7:        46113002      84114007 116680003                 0   TRUE
##  8:        48447003      84114007 116680003                 0   TRUE
##  9:        55565007      84114007 116680003                 0   TRUE
## 10:        56675007      84114007 116680003                 0   TRUE
## 11:        85232009      84114007 116680003                 0   TRUE
## 12:        89819002      84114007 116680003                 0   TRUE
## 13:       161505003      84114007 246090004                 1   TRUE
## 14:       195111005      84114007 116680003                 0   TRUE
## 15:       195112003      84114007 116680003                 0   TRUE
## 16:       206586007      84114007 116680003                 0   TRUE
## 17:       233924009      84114007 116680003                 0   TRUE
## 18:       236003008      84114007  42752001                 2   TRUE
## 19:       276514007      84114007 116680003                 0   TRUE
## 20:       309634009      84114007 246090004                 1   TRUE
## 21:       313389004      84114007 246090004                 1   TRUE
## 22:       314206003      84114007 116680003                 0   TRUE
## 23:       367363000      84114007 116680003                 0   TRUE
## 24:       390868005      84114007 363702006                 2   TRUE
## 25:       394887005      84114007 246090004                 1   TRUE
## 26:       394927007      84114007 246090004                 1   TRUE
## 27:       395105005      84114007 246090004                 1   TRUE
## 28:       410431009      84114007 116680003                 0   TRUE
## 29:       417996009      84114007 116680003                 0   TRUE
## 30:       418304008      84114007 116680003                 0   TRUE
## 31:       423475008      84114007 363702006                 2   TRUE
## 32:       429959009      84114007 246090004                 1   TRUE
## 33:       445236007      84114007 116680003                 0   TRUE
## 34:       446221000      84114007 116680003                 0   TRUE
## 35:       462172006      84114007 116680003                 0   TRUE
## 36:       471880001      84114007 116680003                 0   TRUE
## 37:       609507007      84114007 116680003                 0   TRUE
## 38:       703272007      84114007 116680003                 0   TRUE
## 39:       718287008      84114007 363702006                 2   TRUE
## 40:       722095005      84114007  42752001                 3   TRUE
## 41:       788950000      84114007 116680003                 0   TRUE
## 42: 813991000000101      84114007 363702006                 2   TRUE
##            sourceId destinationId    typeId relationshipGroup active
##                                                                                         sourceDesc
##                                                                                             &lt;char&gt;
##  1:                                                                       Heart failure (disorder)
##  2:                                                                       Heart failure (disorder)
##  3:                                                                       Heart failure (disorder)
##  4:                                                           High output heart failure (disorder)
##  5:                                                            Low output heart failure (disorder)
##  6:                                                            Congestive heart failure (disorder)
##  7:                                                          Hypertensive heart failure (disorder)
##  8:                                                               Chronic heart failure (disorder)
##  9: Cardiac failure after obstetrical surgery AND/OR other procedure including delivery (disorder)
## 10:                                                                 Acute heart failure (disorder)
## 11:                                                                  Left heart failure (disorder)
## 12:                      Cardiac insufficiency during AND/OR resulting from a procedure (disorder)
## 13:                                                           History of heart failure (situation)
## 14:                                                       Decompensated cardiac failure (disorder)
## 15:                                                         Compensated cardiac failure (disorder)
## 16:                                                          Congenital cardiac failure (disorder)
## 17:                                             Heart failure as a complication of care (disorder)
## 18:                                                                     Cardiac ascites (disorder)
## 19:                                                            Neonatal cardiac failure (disorder)
## 20:                                              History of heart failure in last year (situation)
## 21:                                                                 No cardiac failure (situation)
## 22:                                                            Refractory heart failure (disorder)
## 23:                                                           Right ventricular failure (disorder)
## 24:                                                               Heart failure screen (procedure)
## 25:                                                            Suspected heart failure (situation)
## 26:                                                             Heart failure excluded (situation)
## 27:                                                            Heart failure confirmed (situation)
## 28:                                                           Cardiorespiratory failure (disorder)
## 29:                                                              Systolic heart failure (disorder)
## 30:                                                             Diastolic heart failure (disorder)
## 31:                                                            Heart failure education (procedure)
## 32:                                                    Family history of heart failure (situation)
## 33:                                                                Cardiorenal syndrome (disorder)
## 34:                                         Heart failure with normal ejection fraction (disorder)
## 35:                                                                 Fetal heart failure (disorder)
## 36:                             Heart failure due to end stage congenital heart disease (disorder)
## 37:                     Induced termination of pregnancy complicated by cardiac failure (disorder)
## 38:                                        Heart failure with reduced ejection fraction (disorder)
## 39:                               Provision of written information about heart failure (procedure)
## 40:                                      Acute kidney injury due to circulatory failure (disorder)
## 41:                                      Heart failure with mid range ejection fraction (disorder)
## 42:                                        Education about deteriorating heart failure (procedure)
##                                                                                         sourceDesc
##                             destinationDesc                       typeDesc
##                                      &lt;char&gt;                         &lt;char&gt;
##  1: Disorder of cardiac function (disorder)               Is a (attribute)
##  2:        Heart structure (body structure)       Finding site (attribute)
##  3:              Impaired (qualifier value) Has interpretation (attribute)
##  4:                Heart failure (disorder)               Is a (attribute)
##  5:                Heart failure (disorder)               Is a (attribute)
##  6:                Heart failure (disorder)               Is a (attribute)
##  7:                Heart failure (disorder)               Is a (attribute)
##  8:                Heart failure (disorder)               Is a (attribute)
##  9:                Heart failure (disorder)               Is a (attribute)
## 10:                Heart failure (disorder)               Is a (attribute)
## 11:                Heart failure (disorder)               Is a (attribute)
## 12:                Heart failure (disorder)               Is a (attribute)
## 13:                Heart failure (disorder) Associated finding (attribute)
## 14:                Heart failure (disorder)               Is a (attribute)
## 15:                Heart failure (disorder)               Is a (attribute)
## 16:                Heart failure (disorder)               Is a (attribute)
## 17:                Heart failure (disorder)               Is a (attribute)
## 18:                Heart failure (disorder)             Due to (attribute)
## 19:                Heart failure (disorder)               Is a (attribute)
## 20:                Heart failure (disorder) Associated finding (attribute)
## 21:                Heart failure (disorder) Associated finding (attribute)
## 22:                Heart failure (disorder)               Is a (attribute)
## 23:                Heart failure (disorder)               Is a (attribute)
## 24:                Heart failure (disorder)          Has focus (attribute)
## 25:                Heart failure (disorder) Associated finding (attribute)
## 26:                Heart failure (disorder) Associated finding (attribute)
## 27:                Heart failure (disorder) Associated finding (attribute)
## 28:                Heart failure (disorder)               Is a (attribute)
## 29:                Heart failure (disorder)               Is a (attribute)
## 30:                Heart failure (disorder)               Is a (attribute)
## 31:                Heart failure (disorder)          Has focus (attribute)
## 32:                Heart failure (disorder) Associated finding (attribute)
## 33:                Heart failure (disorder)               Is a (attribute)
## 34:                Heart failure (disorder)               Is a (attribute)
## 35:                Heart failure (disorder)               Is a (attribute)
## 36:                Heart failure (disorder)               Is a (attribute)
## 37:                Heart failure (disorder)               Is a (attribute)
## 38:                Heart failure (disorder)               Is a (attribute)
## 39:                Heart failure (disorder)          Has focus (attribute)
## 40:                Heart failure (disorder)             Due to (attribute)
## 41:                Heart failure (disorder)               Is a (attribute)
## 42:                Heart failure (disorder)          Has focus (attribute)
##                             destinationDesc                       typeDesc</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># &#39;Finding site&#39; of a particular disorder</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">relatedConcepts</span>(<span class="st">&#39;Heart failure&#39;</span>, <span class="st">&#39;Finding site&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;80891009 | Heart structure (body structure)&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># Disorders with a &#39;Finding site&#39; of &#39;Heart&#39;</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">relatedConcepts</span>(<span class="st">&#39;Heart&#39;</span>, <span class="st">&#39;Finding site&#39;</span>, <span class="dt">reverse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;5053004 | Cardiac insufficiency due to prosthesis (disorder)&quot;             
##  [2] &quot;10091002 | High output heart failure (disorder)&quot;                          
##  [3] &quot;13213009 | Congenital heart disease (disorder)&quot;                           
##  [4] &quot;25544003 | Low output heart failure (disorder)&quot;                           
##  [5] &quot;33644002 | Postvalvulotomy syndrome (disorder)&quot;                           
##  [6] &quot;36221001 | Benign hypertensive heart disease (disorder)&quot;                  
##  [7] &quot;40172005 | Cardiac complication (disorder)&quot;                               
##  [8] &quot;44088000 | Low cardiac output syndrome (disorder)&quot;                        
##  [9] &quot;46113002 | Hypertensive heart failure (disorder)&quot;                         
## [10] &quot;48447003 | Chronic heart failure (disorder)&quot;                              
## [11] &quot;54225002 | Malignant hypertensive heart disease (disorder)&quot;               
## [12] &quot;55565007 | Cardiac failure after obstetrical surgery AND/OR other proc...&quot;
## [13] &quot;56265001 | Heart disease (disorder)&quot;                                      
## [14] &quot;56675007 | Acute heart failure (disorder)&quot;                                
## [15] &quot;60856006 | Cardiac insufficiency following cardiac surgery (disorder)&quot;    
## [16] &quot;64715009 | Hypertensive heart disease (disorder)&quot;                         
## [17] &quot;68583001 | Auricular dilatation (disorder)&quot;                               
## [18] &quot;78643003 | Postcardiotomy syndrome (disorder)&quot;                            
## [19] &quot;84114007 | Heart failure (disorder)&quot;                                      
## [20] &quot;86234004 | Hypertensive heart AND renal disease (disorder)&quot;               
## [21] &quot;89819002 | Cardiac insufficiency during AND/OR resulting from a proced...&quot;
## [22] &quot;105981003 | Disorder of cardiac function (disorder)&quot;                      
## [23] &quot;127337006 | Acute heart disease (disorder)&quot;                               
## [24] &quot;128238001 | Chronic heart disease (disorder)&quot;                             
## [25] &quot;128599005 | Structural disorder of heart (disorder)&quot;                      
## [26] &quot;195111005 | Decompensated cardiac failure (disorder)&quot;                     
## [27] &quot;195112003 | Compensated cardiac failure (disorder)&quot;                       
## [28] &quot;195130005 | Post cardiac operation functional disturbance (disorder)&quot;     
## [29] &quot;206586007 | Congenital cardiac failure (disorder)&quot;                        
## [30] &quot;233924009 | Heart failure as a complication of care (disorder)&quot;           
## [31] &quot;276514007 | Neonatal cardiac failure (disorder)&quot;                          
## [32] &quot;301095005 | Cardiac finding (finding)&quot;                                    
## [33] &quot;314206003 | Refractory heart failure (disorder)&quot;                          
## [34] &quot;362999008 | Cardiac complication of procedure (disorder)&quot;                 
## [35] &quot;410431009 | Cardiorespiratory failure (disorder)&quot;                         
## [36] &quot;417996009 | Systolic heart failure (disorder)&quot;                            
## [37] &quot;418304008 | Diastolic heart failure (disorder)&quot;                           
## [38] &quot;424404003 | Decompensated chronic heart failure (disorder)&quot;               
## [39] &quot;430901004 | Fetal heart disorder (disorder)&quot;                              
## [40] &quot;441481004 | Chronic systolic heart failure (disorder)&quot;                    
## [41] &quot;441530006 | Chronic diastolic heart failure (disorder)&quot;                   
## [42] &quot;443253003 | Acute on chronic systolic heart failure (disorder)&quot;           
## [43] &quot;443254009 | Acute systolic heart failure (disorder)&quot;                      
## [44] &quot;443343001 | Acute diastolic heart failure (disorder)&quot;                     
## [45] &quot;443344007 | Acute on chronic diastolic heart failure (disorder)&quot;          
## [46] &quot;445236007 | Cardiorenal syndrome (disorder)&quot;                              
## [47] &quot;446221000 | Heart failure with normal ejection fraction (disorder)&quot;       
## [48] &quot;462172006 | Fetal heart failure (disorder)&quot;                               
## [49] &quot;462175008 | Fetal heart failure with redistribution of cardiac output ...&quot;
## [50] &quot;471880001 | Heart failure due to end stage congenital heart disease (d...&quot;
## [51] &quot;473383000 | Abnormality of fetal heart (disorder)&quot;                        
## [52] &quot;609507007 | Induced termination of pregnancy complicated by cardiac fa...&quot;
## [53] &quot;703272007 | Heart failure with reduced ejection fraction (disorder)&quot;      
## [54] &quot;703273002 | Heart failure with reduced ejection fraction due to corona...&quot;
## [55] &quot;703274008 | Heart failure with reduced ejection fraction due to myocar...&quot;
## [56] &quot;703275009 | Heart failure with reduced ejection fraction due to cardio...&quot;
## [57] &quot;703276005 | Heart failure with reduced ejection fraction due to heart ...&quot;
## [58] &quot;704242009 | Fetal heart failure due to extracardiac disease (disorder)&quot;   
## [59] &quot;722095005 | Acute kidney injury due to circulatory failure (disorder)&quot;    
## [60] &quot;722919003 | Neonatal cardiac failure due to decreased left ventricular...&quot;
## [61] &quot;724550005 | Neonatal cardiac failure due to pulmonary overperfusion (d...&quot;
## [62] &quot;788950000 | Heart failure with mid range ejection fraction (disorder)&quot;    
## [63] &quot;871617000 | Low output heart failure due to and following Fontan opera...&quot;
## [64] &quot;120851000119104 | Systolic heart failure stage D (disorder)&quot;              
## [65] &quot;120861000119102 | Systolic heart failure stage C (disorder)&quot;              
## [66] &quot;120881000119106 | Diastolic heart failure stage D (disorder)&quot;             
## [67] &quot;120891000119109 | Diastolic heart failure stage C (disorder)&quot;             
## [68] &quot;153931000119109 | Acute combined systolic and diastolic heart failure ...&quot;
## [69] &quot;153941000119100 | Chronic combined systolic and diastolic heart failur...&quot;
## [70] &quot;153951000119103 | Acute on chronic combined systolic and diastolic hea...&quot;
## [71] &quot;15629741000119102 | Systolic heart failure stage C due to ischemic car...&quot;</code></pre>
</div>
<div id="snomed-ct-codelists" class="section level2">
<h2>SNOMED CT codelists</h2>
<p>The SNOMED CT codelist data type allows a list of SNOMED CT concepts to be curated. It allows codelists to be expressed in three formats:</p>
<ul>
<li>simple – a simple list of concepts, one row per concept. It contains at least 2 columns: ‘conceptId’ and ‘term’</li>
<li>tree – a hierarchical list, in which each concept may be a single concept or include its descendants. It contains at least 4 columns: ‘conceptId’, ‘term’, ‘include_desc’ (whether descendants of the term are included) and ‘included’ (TRUE means it is an inclusion concept, FALSE means it is excluded)</li>
<li>exptree – tree format codelists in which the descendants are also enumerated, and have a missing (NA) entry in the ‘include_desc’ column</li>
</ul>
<p>Tree format codelists may be more concise and easier to understand, but generally need to be converted to the ‘simple’ format (either using this package or equivalent functionality in a SNOMED CT server) in order to be used in practice, e.g. to run queries in a database. The result of the conversion may vary depending on the version of SNOMED CT used.</p>
<p>SNOMEDcodelist objects can be constructed using the function SNOMEDcodelist. The function ‘is.SNOMEDcodelist’ checks if an object is a SNOMEDcodelist (and optionally whether it is of the specified type), and ‘as.SNOMEDcodelist’ converts an object to a SNOMEDcodelist if it is not already.</p>
<p>The following items of metadata can be stored as part of a SNOMEDcodelist object:</p>
<ul>
<li>codelist_name</li>
<li>author</li>
<li>version</li>
<li>date</li>
<li>sct_version (SNOMED CT version taken from the SNOMED environment that was used to create the codelist)</li>
<li>timestamp (automatically created)</li>
<li>format (‘simple’, ‘tree’ or ‘exptree’)</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">SNOMED &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb95-2" title="2"></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="co"># Create a codelist containing all the descendants of</span></a>
<a class="sourceLine" id="cb95-4" title="4"><span class="co"># the concept &#39;Heart failure&#39;</span></a>
<a class="sourceLine" id="cb95-5" title="5">my_heart_failure_codelist &lt;-<span class="st"> </span><span class="kw">SNOMEDcodelist</span>(</a>
<a class="sourceLine" id="cb95-6" title="6">  <span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>), <span class="dt">include_desc =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb95-7" title="7">  <span class="dt">format =</span> <span class="st">&#39;simple&#39;</span>, <span class="dt">codelist_name =</span> <span class="st">&#39;Heart failure&#39;</span>)</a></code></pre></div>
<pre><code>## Converting 1 concept(s) to a codelist</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co"># Original codelist</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">print</span>(my_heart_failure_codelist)</a></code></pre></div>
<pre><code>## SNOMED CT codelist: 
## codelist_name: Heart failure
## version: 
## author: 
## date: 
## timestamp: 2025-01-28 17:06:40
## sct_version: Sample
## format: simple 
## Key: &lt;conceptId&gt;
##              conceptId                                                     term
##        &lt;SNOMEDconcept&gt;                                                   &lt;char&gt;
##   1:            364006                Acute left-sided heart failure (disorder)
##   2:           5053004       Cardiac insufficiency due to prosthesis (disorder)
##   3:           5148006 Hypertensive heart disease with congestive heart fail...
##   4:           5375005   Chronic left-sided congestive heart failure (disorder)
##   5:          10091002                     High output heart failure (disorder)
##  ---                                                                           
##  98: 15629541000119106 Congestive heart failure stage C due to ischemic card...
##  99: 15629591000119103 Congestive heart failure stage B due to ischemic card...
## 100: 15629741000119102 Systolic heart failure stage C due to ischemic cardio...
## 101: 15964701000119109 Acute cor pulmonale co-occurrent and due to saddle em...
## 102: 16838951000119100 Acute on chronic right-sided congestive heart failure...</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># Convert to tree format</span></a>
<a class="sourceLine" id="cb99-2" title="2">tree &lt;-<span class="st"> </span><span class="kw">SNOMEDcodelist</span>(my_heart_failure_codelist, <span class="dt">format =</span> <span class="st">&#39;tree&#39;</span>)</a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">print</span>(tree)</a></code></pre></div>
<pre><code>## SNOMED CT codelist: 
## codelist_name: Heart failure
## version: 
## author: 
## date: 
## timestamp: 2025-01-28 17:06:40
## sct_version: Sample
## format: tree 
## Key: &lt;conceptId&gt;
##          conceptId  inc_d  inclu                     term
##    &lt;SNOMEDconcept&gt; &lt;lgcl&gt; &lt;lgcl&gt;                   &lt;char&gt;
## 1:        84114007   TRUE   TRUE Heart failure (disorder)</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co"># Write out codelist to file</span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="co"># Metadata are stored in a column named &#39;metadata&#39;</span></a>
<a class="sourceLine" id="cb101-3" title="3"><span class="co"># export(tree, file = paste0(tempdir(), &#39;/hf_codes.csv&#39;))</span></a>
<a class="sourceLine" id="cb101-4" title="4"></a>
<a class="sourceLine" id="cb101-5" title="5"><span class="co"># Reload codelist from file (including metadata)</span></a>
<a class="sourceLine" id="cb101-6" title="6"><span class="co"># reloaded_codelist &lt;- as.SNOMEDcodelist(</span></a>
<a class="sourceLine" id="cb101-7" title="7"><span class="co">#  data.table::fread(paste0(tempdir(), &#39;/hf_codes.csv&#39;)))</span></a>
<a class="sourceLine" id="cb101-8" title="8"><span class="co"># print(reloaded_codelist)</span></a></code></pre></div>
</div>
<div id="history-of-snomed-ct-concepts" class="section level2">
<h2>‘History of’ SNOMED CT concepts</h2>
<p>Some SNOMED CT concepts state ‘History of’ a disorder or procedure, such as ‘History of heart failure’. These concepts may be important to include in a search for patients with a past history of a condition, which may be recorded using either the disorder concept or a history concept.</p>
<p>‘History of’ concepts are of the semantic type ‘Situation’ with attributes:</p>
<ul>
<li>Temporal context = In the past</li>
<li>Associated finding = concept ID of the historic condition</li>
<li>Finding context = Known present</li>
<li>Subject relationship context = Subject of record</li>
</ul>
<p>‘Suspected’ concepts are also of the semantic type ‘Situation’ and have the following attributes:</p>
<ul>
<li>Temporal context = Current or specified time</li>
<li>Associated finding = concept ID of the condition that is suspected</li>
<li>Finding context = Suspected</li>
<li>Subject relationship context = Subject of record</li>
</ul>
<p>The sample SNOMED dictionary included in this package does not include all these attributes, so the following examples require a full SNOMED CT dictionary to be loaded.</p>
<pre><code>find_historic &lt;- function(x, SNOMED){
  # returns a vector of concepts which are historic versions of
  # the supplied concepts
  # Arguments: x = a SNOMEDconcept vector
  #            SNOMED = a SNOMED environment

  R &lt;- unique(relatedConcepts(x,
    type = SNOMEDconcept(&#39;Associated finding&#39;), reverse = TRUE))
  Rpast = hasAttributes(R,
    typeIds = SNOMEDconcept(&#39;Temporal context&#39;),
    destinationIds = SNOMEDconcept(&#39;In the past&#39;), SNOMED = SNOMED)
  Rknown = hasAttributes(R,
    typeIds = SNOMEDconcept(&#39;Finding context&#39;),
    destinationIds = SNOMEDconcept(&#39;Known present&#39;), SNOMED = SNOMED)
  Rsubj = hasAttributes(R,
    typeIds = SNOMEDconcept(&#39;Subject relationship context&#39;),
    destinationIds = SNOMEDconcept(&#39;Subject of record&#39;), SNOMED = SNOMED)
  
  R[Rpast &amp; Rknown &amp; Rsubj]
}

find_suspected &lt;- function(x, SNOMED){
  # returns a vector of concepts which are suspected versions of
  # the supplied concepts
  # Arguments: x = a SNOMEDconcept vector
  #            SNOMED = a SNOMED environment

  R &lt;- unique(relatedConcepts(x,
    type = SNOMEDconcept(&#39;Associated finding&#39;), reverse = TRUE))
  Rcurrent = hasAttributes(R,
    typeIds = SNOMEDconcept(&#39;Temporal context&#39;),
    destinationIds = SNOMEDconcept(&#39;Current or specified time&#39;),
    SNOMED = SNOMED)
  Rsuspected = hasAttributes(R,
    typeIds = SNOMEDconcept(&#39;Finding context&#39;),
    destinationIds = SNOMEDconcept(&#39;Suspected&#39;), SNOMED = SNOMED)
  Rsubj = hasAttributes(R,
    typeIds = SNOMEDconcept(&#39;Subject relationship context&#39;),
    destinationIds = SNOMEDconcept(&#39;Subject of record&#39;), SNOMED = SNOMED)
  
  R[Rcurrent &amp; Rsuspected &amp; Rsubj]
}

# Example (using full SNOMED CT dictionary):
#
# &gt; find_historic(SNOMEDconcept(&#39;Heart failure&#39;), SNOMED)
# [1] &quot;309634009 | History of heart failure in last year (situation)&quot;
# [2] &quot;161505003 | History of heart failure (situation)&quot;
#             
# &gt; find_suspected(SNOMEDconcept(&#39;Heart failure&#39;), SNOMED)
# [1] &quot;394887005 | Suspected heart failure (situation)&quot; </code></pre>
</div>
<div id="snomed-ct-simple-refsets" class="section level2">
<h2>SNOMED CT simple refsets</h2>
<p>Refsets are sets of SNOMED CT terms (like codelists) that are supplied as part of the SNOMED CT distribution and are used for operational purposes. They are included in the REFSET table in the SNOMED dictionary. The getRefset function retrieves a particular refset. Each refset has a name which is a SNOMED CT concept of semantic type ‘foundation metadata concept’.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">SNOMED =<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb103-2" title="2"></a>
<a class="sourceLine" id="cb103-3" title="3"><span class="co"># Obtain a list of available refsets with descriptions and counts</span></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="kw">merge</span>(SNOMED<span class="op">$</span>REFSET[, .N, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">conceptId =</span> refsetId)],</a>
<a class="sourceLine" id="cb103-5" title="5">  SNOMED<span class="op">$</span>DESCRIPTION[, <span class="kw">list</span>(conceptId, term)], <span class="dt">by =</span> <span class="st">&#39;conceptId&#39;</span>)</a></code></pre></div>
<pre><code>## Key: &lt;conceptId&gt;
##              conceptId     N
##                  &lt;i64&gt; &lt;int&gt;
##  1:    991381000000107     4
##  2:    991381000000107     4
##  3:    991401000000107     1
##  4:    991401000000107     1
##  5:    991411000000109     2
##  6:    991411000000109     2
##  7:   1127581000000103   102
##  8:   1127581000000103   102
##  9:   1127601000000107   101
## 10:   1127601000000107   101
## 11:   1127821000000102     1
## 12:   1127821000000102     1
## 13: 999000061000000101    26
## 14: 999000061000000101    26
## 15: 999000711000000101    99
## 16: 999000711000000101    99
## 17: 999001061000000106     4
## 18: 999001061000000106     4
## 19: 999001111000000105     3
## 20: 999001111000000105     3
## 21: 999002321000000107    82
## 22: 999002321000000107    82
## 23: 999002571000000104     1
## 24: 999002571000000104     1
## 25: 999004331000000102     1
## 26: 999004331000000102     1
## 27: 999004361000000107     1
## 28: 999004361000000107     1
##              conceptId     N
##                                                                                                                                term
##                                                                                                                              &lt;char&gt;
##  1:                                                                          Comorbid conditions for selection simple reference set
##  2:                                            Comorbid conditions for selection simple reference set (foundation metadata concept)
##  3:                                                             Emergency care presenting complaints or issues simple reference set
##  4:                               Emergency care presenting complaints or issues simple reference set (foundation metadata concept)
##  5:                                                                                   Emergency care diagnosis simple reference set
##  6:                                                     Emergency care diagnosis simple reference set (foundation metadata concept)
##  7:                                                                                              Health issues simple reference set
##  8:                                                                Health issues simple reference set (foundation metadata concept)
##  9:                                                           Healthcare matters simple reference set (foundation metadata concept)
## 10:                                                                                         Healthcare matters simple reference set
## 11:                                                                               Acute kidney injury findings simple reference set
## 12:                                                 Acute kidney injury findings simple reference set (foundation metadata concept)
## 13:                                                     Care planning activities simple reference set (foundation metadata concept)
## 14:                                                                                   Care planning activities simple reference set
## 15:                                                                    Diagnosis simple reference set (foundation metadata concept)
## 16:                                                                                                  Diagnosis simple reference set
## 17:                                                       Renal clinical finding simple reference set (foundation metadata concept)
## 18:                                                                                     Renal clinical finding simple reference set
## 19:                                  United Kingdom diagnostic imaging procedure simple reference set (foundation metadata concept)
## 20:                                                                United Kingdom diagnostic imaging procedure simple reference set
## 21:                                                                          Comorbid conditions comprehensive simple reference set
## 22:                                            Comorbid conditions comprehensive simple reference set (foundation metadata concept)
## 23:                                                                                   Default exclusion filter simple reference set
## 24:                                                     Default exclusion filter simple reference set (foundation metadata concept)
## 25:                                                                              Summary Care Record inclusion simple reference set
## 26:                                                Summary Care Record inclusion simple reference set (foundation metadata concept)
## 27:                               General practice summary data sharing exclusion for termination of pregnancy simple reference set
## 28: General practice summary data sharing exclusion for termination of pregnancy simple reference set (foundation metadata concept)
##                                                                                                                                term</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># Obtain a refset as a SNOMEDconcept vector</span></a>
<a class="sourceLine" id="cb105-2" title="2">renal_ref &lt;-<span class="st"> </span><span class="kw">getRefset</span>(<span class="st">&#39;Renal clinical finding simple reference set&#39;</span>)</a>
<a class="sourceLine" id="cb105-3" title="3"></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="co"># Find out whether a concept is included in a refset</span></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Renal failure&#39;</span>) <span class="op">%in%</span><span class="st"> </span>renal_ref</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="mapping-between-snomed-ct-and-icd-10-and-opcs4" class="section level2">
<h2>Mapping between SNOMED CT and ICD-10 and OPCS4</h2>
<p>Mapping tables are provided in the international and UK SNOMED CT distributions for ICD-10. The UK distribution also includes mappings to CTV3, ICD Oncology (ICD-O) for body locations and OPCS4.</p>
<p>These mappings are designed to enable clinical data entered using SNOMED CT to be converted to ICD-10 or OPCS4 in a semi-automated manner. This package includes functions to use the mappings to convert codelists from one format to another. Beware that these code systems are not equivalent, so it is necessary to check the output codelist to ensure that the mapping makes sense. For ICD-10 maps, only maps with mapCategoryId = ‘Map source concept is properly classified’ are retrieved.</p>
<p>The table SIMPLEMAPS contains maps to CTV3 and ICD-O, whereas EXTENDEDMAPS contains mappings to ICD-10 and OPCS4. The EXTENDEDMAPS tables contains additional columns to define the type of mapping, but they are not used by the functions in this package.</p>
<p>The <code>getMaps</code> function can be used to conveniently return the ICD-10 or OPCS4 codes associated with a SNOMED CT concept. Note that in the output data.table, the icd10_code or opcs4_code column is a list (because there may be multiple entries per SNOMED CT concept). To return each map on a separate row, use getMaps with the option <code>single_row_per_concept = FALSE</code>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># Example: creating an ICD-10 heart failure codelist using SNOMED CT</span></a>
<a class="sourceLine" id="cb107-2" title="2">SNOMED &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb107-3" title="3"></a>
<a class="sourceLine" id="cb107-4" title="4">my_heart_failure_codelist &lt;-<span class="st"> </span><span class="kw">SNOMEDcodelist</span>(</a>
<a class="sourceLine" id="cb107-5" title="5">  <span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>), <span class="dt">include_desc =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## Converting 1 concept(s) to a codelist</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw">getMaps</span>(my_heart_failure_codelist, <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&#39;icd10&#39;</span>))</a>
<a class="sourceLine" id="cb109-2" title="2"></a>
<a class="sourceLine" id="cb109-3" title="3">my_pacemaker_codelist &lt;-<span class="st"> </span><span class="kw">SNOMEDcodelist</span>(</a>
<a class="sourceLine" id="cb109-4" title="4">  <span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Implantation of cardiac pacemaker&#39;</span>),</a>
<a class="sourceLine" id="cb109-5" title="5">  <span class="dt">include_desc =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## Converting 1 concept(s) to a codelist</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">getMaps</span>(my_pacemaker_codelist, <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&#39;opcs4&#39;</span>))</a></code></pre></div>
</div>
<div id="mapping-between-snomed-ct-and-read-clinical-terminology" class="section level2">
<h2>Mapping between SNOMED CT and Read Clinical Terminology</h2>
<p>Prior to the introduction of SNOMED CT, the Read Clinical Terminology (version 2 or 3) were used to record clinical information in UK general practice. SNOMED CT terms are partly derived from Read, so all Read terms have a ‘forward’ mapping to an appropriate SNOMED CT term. NHS Digital provides a set of mappings to enable these conversions in clinical systems that are moving to SNOMED CT. These tables are available from the Technology Reference data Update Distribution .</p>
<p>This package provides the ‘loadMAPS’ function for loading the NHS Digital files into an R data.table, the ‘MAPS’ sample dataset and the ‘getMaps’ function for retrieving Read Clinical Terms Version 2 (Read 2) and Clinical Terms Version 3 (CTV3) that map to a set of SNOMED CT concepts.</p>
<p>These maps can be used for converting SNOMED CT codelists into Read 2 or CTV3 format for running queries, such as to characterise patient phenotypes or identify patient populations for research. They cannot be used in the reverse direction (to map a Read 2/CTV3 codelist to SNOMED CT) because some of the SNOMED CT terms will be missed out, and the list will be incomplete.</p>
<p>Use the ‘unlist’ function, followed by deduplication, to create a table of concepts in another coding system mapped from SNOMED CT, as in the example below.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="co"># Example: creating a Read heart failure codelist using SNOMED CT</span></a>
<a class="sourceLine" id="cb112-2" title="2">SNOMED &lt;-<span class="st"> </span><span class="kw">sampleSNOMED</span>()</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="kw">data</span>(READMAPS)</a>
<a class="sourceLine" id="cb112-4" title="4"></a>
<a class="sourceLine" id="cb112-5" title="5"><span class="co"># Start off with a SNOMED CT codelist containing the descendants of</span></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="co"># the concept &#39;Heart failure&#39;</span></a>
<a class="sourceLine" id="cb112-7" title="7">my_heart_failure_codelist &lt;-<span class="st"> </span><span class="kw">SNOMEDcodelist</span>(</a>
<a class="sourceLine" id="cb112-8" title="8">  <span class="kw">SNOMEDconcept</span>(<span class="st">&#39;Heart failure&#39;</span>), <span class="dt">include_desc =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Converting 1 concept(s) to a codelist</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">single_row_maps &lt;-<span class="st"> </span><span class="kw">getMaps</span>(my_heart_failure_codelist,</a>
<a class="sourceLine" id="cb114-2" title="2">  <span class="dt">mappingtable =</span> READMAPS, <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&#39;read2&#39;</span>, <span class="st">&#39;ctv3&#39;</span>),</a>
<a class="sourceLine" id="cb114-3" title="3">  <span class="dt">single_row_per_concept =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb114-4" title="4"></a>
<a class="sourceLine" id="cb114-5" title="5"><span class="co"># Display the maps - one row per concept (long terms truncated)</span></a>
<a class="sourceLine" id="cb114-6" title="6"><span class="kw">print</span>(single_row_maps[, <span class="kw">list</span>(<span class="dt">term =</span> <span class="kw">substr</span>(term, <span class="dv">1</span>, <span class="dv">10</span>), read2_code,</a>
<a class="sourceLine" id="cb114-7" title="7">  ctv3_concept)])</a></code></pre></div>
<pre><code>## SNOMED CT codelist: 
## codelist_name: 
## version: 
## author: 
## date: 
## timestamp: 
## sct_version: 
## format:  
##            term read2_code ctv3_concept
##          &lt;char&gt;     &lt;list&gt;       &lt;list&gt;
##   1: Acute left                        
##   2: Cardiac in                        
##   3: Hypertensi                        
##   4: Chronic le                        
##   5: High outpu                        
##  ---                                   
##  98: Congestive                        
##  99: Congestive                        
## 100: Systolic h                        
## 101: Acute cor                         
## 102: Acute on c</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">multi_row_maps &lt;-<span class="st"> </span><span class="kw">getMaps</span>(my_heart_failure_codelist,</a>
<a class="sourceLine" id="cb116-2" title="2">  <span class="dt">mappingtable =</span> READMAPS, <span class="dt">to =</span> <span class="st">&#39;read2&#39;</span>,</a>
<a class="sourceLine" id="cb116-3" title="3">  <span class="dt">single_row_per_concept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb116-4" title="4"></a>
<a class="sourceLine" id="cb116-5" title="5"><span class="co"># Display the maps - multiple rows per concept (long terms truncated)</span></a>
<a class="sourceLine" id="cb116-6" title="6"><span class="kw">print</span>(multi_row_maps[, <span class="kw">list</span>(<span class="dt">term =</span> <span class="kw">substr</span>(term, <span class="dv">1</span>, <span class="dv">10</span>), read2_code,</a>
<a class="sourceLine" id="cb116-7" title="7">  <span class="dt">read2_term =</span> <span class="kw">substr</span>(read2_term, <span class="dv">1</span>, <span class="dv">30</span>))])</a></code></pre></div>
<pre><code>##           term read2_code                     read2_term
##         &lt;char&gt;     &lt;char&gt;                         &lt;char&gt;
##  1: Acute cong    G580000 Acute congestive heart failure
##  2: Congestive    G580.00       Congestive heart failure
##  3: Congestive    G580.11     Congestive cardiac failure
##  4: Rheumatic     G1yz100 Rheumatic left ventricular fai
##  5: Acute cor     G400.00            Acute cor pulmonale
##  6: Acute hear    G582.00            Acute heart failure
##  7: Cardiac as    G581.11               Asthma - cardiac
##  8: Chronic co    G41z.11          Chronic cor pulmonale
##  9: Malignant     G210100 Malignant hypertensive heart d
## 10: Heart fail    G58..00                  Heart failure
## 11: Heart fail    G58z.00              Heart failure NOS
## 12: Heart fail    G58z.11                     Weak heart
## 13: Heart fail    G58z.12            Cardiac failure NOS
## 14: Heart fail    G58..11                Cardiac failure
## 15: Left heart    G581.00       Left ventricular failure
## 16: Chronic co    G580100 Chronic congestive heart failu
## 17: Biventricu    G580.14          Biventricular failure
## 18: Benign hyp    G211100 Benign hypertensive heart dise
## 19: Hypertensi    G232.00 Hypertensive heart and renal d
## 20: Hypertensi    G234.00 Hypertensive heart and renal d
## 21: Decompensa    G580200  Decompensated cardiac failure
## 22: Compensate    G580300    Compensated cardiac failure
## 23: Acute left    G581000 Acute left ventricular failure
## 24: Congenital    Q48y100     Congenital cardiac failure
## 25: Heart fail    SP11111 Heart failure as a complicatio
## 26: Neonatal c    Q490.00       Neonatal cardiac failure
## 27: Right vent    G580.13      Right ventricular failure
## 28: Right vent    G584.00      Right ventricular failure
## 29: Cardioresp    R2y1000   [D]Cardiorespiratory failure
## 30: Congestive    G580400 Congestive heart failure due t
## 31: Heart fail    G583.12 Heart failure with preserved e
## 32: Heart fail    G583.11 HFNEF - heart failure with nor
## 33: Heart fail    G583.00 Heart failure with normal ejec
## 34: Induced te    L09y200 Cardiac failure following abor
##           term read2_code                     read2_term</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co"># Create a standalone Read2 codelist</span></a>
<a class="sourceLine" id="cb118-2" title="2">read_codelist &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">data.table</span>(</a>
<a class="sourceLine" id="cb118-3" title="3">  <span class="dt">code =</span> <span class="kw">unlist</span>(single_row_maps<span class="op">$</span>read2_code),</a>
<a class="sourceLine" id="cb118-4" title="4">  <span class="dt">term =</span> <span class="kw">unlist</span>(single_row_maps<span class="op">$</span>read2_term))</a>
<a class="sourceLine" id="cb118-5" title="5"><span class="kw">print</span>(read_codelist[<span class="op">!</span><span class="kw">duplicated</span>(read_codelist)][<span class="kw">order</span>(code)])</a></code></pre></div>
<pre><code>##        code
##      &lt;char&gt;
##  1: G1yz100
##  2: G210100
##  3: G211100
##  4: G232.00
##  5: G234.00
##  6: G400.00
##  7: G41z.11
##  8: G58..00
##  9: G58..11
## 10: G580.00
## 11: G580.11
## 12: G580.13
## 13: G580.14
## 14: G580000
## 15: G580100
## 16: G580200
## 17: G580300
## 18: G580400
## 19: G581.00
## 20: G581.11
## 21: G581000
## 22: G582.00
## 23: G583.00
## 24: G583.11
## 25: G583.12
## 26: G584.00
## 27: G58z.00
## 28: G58z.11
## 29: G58z.12
## 30: L09y200
## 31: Q48y100
## 32: Q490.00
## 33: R2y1000
## 34: SP11111
##        code
##                                                                                            term
##                                                                                          &lt;char&gt;
##  1:                                                          Rheumatic left ventricular failure
##  2:                        Malignant hypertensive heart disease with congestive cardiac failure
##  3:                           Benign hypertensive heart disease with congestive cardiac failure
##  4:                        Hypertensive heart and renal disease with (congestive) heart failure
##  5: Hypertensive heart and renal disease with both (congestive) heart failure and renal failure
##  6:                                                                         Acute cor pulmonale
##  7:                                                                       Chronic cor pulmonale
##  8:                                                                               Heart failure
##  9:                                                                             Cardiac failure
## 10:                                                                    Congestive heart failure
## 11:                                                                  Congestive cardiac failure
## 12:                                                                   Right ventricular failure
## 13:                                                                       Biventricular failure
## 14:                                                              Acute congestive heart failure
## 15:                                                            Chronic congestive heart failure
## 16:                                                               Decompensated cardiac failure
## 17:                                                                 Compensated cardiac failure
## 18:                                            Congestive heart failure due to valvular disease
## 19:                                                                    Left ventricular failure
## 20:                                                                            Asthma - cardiac
## 21:                                                              Acute left ventricular failure
## 22:                                                                         Acute heart failure
## 23:                                                 Heart failure with normal ejection fraction
## 24:                                         HFNEF - heart failure with normal ejection fraction
## 25:                                              Heart failure with preserved ejection fraction
## 26:                                                                   Right ventricular failure
## 27:                                                                           Heart failure NOS
## 28:                                                                                  Weak heart
## 29:                                                                         Cardiac failure NOS
## 30:                                                Cardiac failure following abortive pregnancy
## 31:                                                                  Congenital cardiac failure
## 32:                                                                    Neonatal cardiac failure
## 33:                                                                [D]Cardiorespiratory failure
## 34:                                                     Heart failure as a complication of care
##                                                                                            term</code></pre>
</div>
<div id="more-information" class="section level2">
<h2>More information</h2>
<p>For more information about SNOMED CT, visit the SNOMED CT international website: <a href="https://www.snomed.org/" class="uri">https://www.snomed.org/</a></p>
<p>SNOMED CT (UK edition) can be downloaded from the NHS Digital site: <a href="https://isd.digital.nhs.uk/trud/user/guest/group/0/home" class="uri">https://isd.digital.nhs.uk/trud/user/guest/group/0/home</a></p>
<p>The NHS Digital terminology browser can be used to search for terms interactively: <a href="https://termbrowser.nhs.uk/" class="uri">https://termbrowser.nhs.uk/</a></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
